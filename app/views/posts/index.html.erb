<div id="notice"><%= notice %></div>

<h1>Posts</h1>
<ul>
  <% @posts.each do |post| %>
    <li id="post_<%= post.id %>">
      <%= post.created_at %>
      <%= link_to post.title, post_path(post) %> (<%= post.comments.size %>)
      <%= link_to 'Edit', edit_post_path(post) %>
      <%= link_to 'Delete', post, :confirm => '投稿を削除します',
                                  :method => :delete,
                                  :remote => true %>
    </li>
  <% end %>
</ul>

<script>
$(function(){
  setTimeout(function() {
      $('#notice').fadeOut('slow');
    }, 800);

  $('a[data-method="delete"]').on('ajax:success', function(e, data, status, xhr) {
    $('#post_' + data.post.id).fadeOut('slow');
   });
});
</script>
